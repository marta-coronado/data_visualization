plotK
b1 <- fread("b1.tsv")
plotK <- ggplot(b1[b1$type=="Including heterochromatin",], aes(color = chrom, y = mean, x = stat)) +
geom_errorbar(aes(ymin = mean - se,
ymax = mean + se,
width = 0.15)) +
geom_point() +
#facet_grid(.~type) +
labs(x = "", color = "Chromosome", y = "Mean") +
theme_cowplot() +
#ggtitle(unique(b1$analysis)) +
scale_color_manual(values = c("#4dbfbc","#ffa500")) +
theme(legend.position = "none") +
scale_x_discrete(labels=c(expression(italic(F)[GT]), expression(italic(F)[SG]), expression(italic(F)[ST])))
#ggtitle(unique(b1$analysis))
plotK
hier_fst <- b1[b1$type=="Including heterochromatin",]
hier_fst[hier_fst$stat=="Fst",]$stat<-"hFst"
fig6a_b <- rbind(standard_fst, hier_fst)
fig6a_b$stat<-factor(fig6a_b$stat,levels = c("Fst","hFst","Fgt","Fsg"))
plot_fig6a_b <- ggplot(fig6a_b, aes(color = chrom, y = mean, x = stat)) +
geom_errorbar(aes(ymin = mean - se,
ymax = mean + se,
width = 0.15)) +
geom_point() +
#facet_grid(.~type) +
labs(x = "", color = "Chromosome", y = "Value") +
theme_cowplot() +
#ggtitle(unique(b1$analysis)) +
scale_color_manual(values = c("#4dbfbc","#ffa500")) +
theme(legend.position = "none") +
scale_x_discrete(breaks=c("Fst","hFst","Fgt","Fsg"),labels=c(expression(italic(F)[ST]), expression(h~italic(F)[ST]), expression(italic(F)[GT]), expression(italic(F)[SG])))+
geom_vline(xintercept = 1.5, linetype = "dashed", color = "gray")  # Add a dashed line between Fst and hFst
#ggtitle(unique(b1$analysis))
plot_fig6a_b
a1_FST_clusters[a1_FST_clusters$cluster=="4-Oceania",]$cluster<-"4-Australia"
a1_FST_clusters[a1_FST_clusters$cluster=="3-Oceania",]$cluster<-"3-Australia"
a1_FST_clusters <- a1_FST_i_clusters
a1_FST_clusters[a1_FST_clusters$cluster=="4-Oceania",]$cluster<-"4-Australia"
a1_FST_clusters[a1_FST_clusters$cluster=="3-Oceania",]$cluster<-"3-Australia"
plotL <- ggplot(a1_FST_clusters, aes(color = chrom, y = mean, x = reorder(cluster,mean))) +
geom_errorbar(aes(ymin = mean - se,
ymax = mean + se,
width = 0.15)) +
geom_point() +
labs(x = "", color = "", y = expression("Continental"~italic(F)[ST])) +
theme_cowplot() +
scale_color_manual(values = c("#4dbfbc","#ffa500")) +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1),
legend.position = c(0.1, 0.9),  # Top-left position
legend.justification = c(0, 1))  # Align legend to the top-left corner
plotL
a1_FST_clusters_rev_SA<-unique(a1_FST_clusters)
a1_FST_clusters_rev_SA[a1_FST_clusters_rev_SA$chrom=="Autosomes" & a1_FST_clusters_rev_SA$cluster=="4-S. America", ]$mean <- 0.087668478
a1_FST_clusters_rev_SA[a1_FST_clusters_rev_SA$chrom=="Autosomes" & a1_FST_clusters_rev_SA$cluster=="4-S. America", ]$se <- 0.001806
a1_FST_clusters_rev_SA[a1_FST_clusters_rev_SA$chrom=="X" & a1_FST_clusters_rev_SA$cluster=="4-S. America", ]$mean <- 0.109017758
a1_FST_clusters_rev_SA
load("/home/mcoronado/Desktop/DEST/Figure4/R01/a1_FST_aut_i_4-South_Americaremove_BR_EC.RData")
load("/home/mcoronado/Desktop/DEST/Figure4/R01/a1_FST_aut_i_4-South_Americaremove_BR_EC.RData")
prueba <- load("/home/mcoronado/Desktop/DEST/Figure4/R01/a1_FST_aut_i_4-South_Americaremove_BR_EC.RData")
load("/home/mcoronado/Desktop/DEST/Figure4/R01/a1_FST_aut_i_4-South_Americaremove_BR_EC.RData")
View(a1_FST_i_clusters)
load("/home/mcoronado/Desktop/DEST/Figure4/R01/a1_FST_aut_i.RData")
View(a1_FST_i_clusters)
View(computeFst)
load("/home/mcoronado/Desktop/DEST/Figure4/R01/a1_FST_aut_i.RData")
load("/home/mcoronado/Desktop/DEST/Figure4/R01/a1_FST_i_clusters.RData")
View(computeFst)
plot_fig6a_b
plotL
left<-plot_grid(plot_fig6a_b,plotL,ncol = 1, rel_widths = c(0.5,1), align = "h", labels=c("A","C"))
plot_grid(left,plotH$gtable,ncol = 2, labels=c("","B"), rel_widths = c(0.5,1))
ggsave("Figure4_new.pdf", height = 6, width = 10)
setwd("/run/user/1000/gvfs/sftp:host=ft3.cesga.es,user=csgcyjgp/mnt/netapp2/Home_FT2/home/csic/gcy/jgp/extra_storage/LUCIA/TEmerics/results_Dmel_dess/comparison")
chimerics_joel <- data.table::fread("Chimerics_Joel_version.tab")
chimerics_joel<-chimerics_joel[chimerics_joel$strain=="COR-023",]
chimerics_joel
chimerics_new <- data.table::fread("Chimerics.tab")
library(ggvenn)
ggvenn(
x,
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
ggvenn(
list(BTH=unique(chimerics_joel$gene), NEW=unique(chimerics_new$gene)),
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
ggvenn(
list(BTH=unique(chimerics_joel$gene), NEW=unique(chimerics_new$gene)),
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
length(unique(chimerics_joel$gene))
length(unique(chimerics_new$gene))
length(unique(chimerics_new[chimerics_new$condition=="Desiccation",]$gene))
unique(chimerics_new$condition)
length(unique(chimerics_joel[chimerics_joel$condition=="Control",]$gene))
length(unique(chimerics_new[chimerics_new$condition=="Dessication",]$gene))
length(unique(chimerics_joel[chimerics_joel$condition=="Control",]$gene))
length(unique(chimerics_new[chimerics_new$condition=="Control",]$gene))
length(unique(chimerics_joel[chimerics_joel$condition=="Dessication",]$gene))
length(unique(chimerics_new[chimerics_new$condition=="Dessication",]$gene))
ggvenn(
list(BTH=unique(chimerics_joel[chimerics_joel$condition=="Control",]$gene), NEW=unique(chimerics_new[chimerics_joel$condition=="Control",]$gene)),
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
ggvenn(
list(BTH=unique(chimerics_joel[chimerics_joel$condition=="Control",]$gene), NEW=unique(chimerics_new[chimerics_joel$condition=="Control",]$gene)),
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
ggvenn(
list(BTH=unique(chimerics_joel[chimerics_joel$condition=="Control",]$gene), NEW=unique(chimerics_new[chimerics_new$condition=="Control",]$gene)),
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
ggvenn(
list(BTH=unique(chimerics_joel[chimerics_joel$condition=="Dessication",]$gene), NEW=unique(chimerics_new[chimerics_new$condition=="Dessication",]$gene)),
fill_color = c("#0073C2FF", "#EFC000FF", "#868686FF", "#CD534CFF"),
stroke_size = 0.5, set_name_size = 4
)
setdiff(unique(chimerics_joel[chimerics_joel$condition=="Dessication",]$gene), unique(chimerics_new[chimerics_new$condition=="Dessication",]$gene))
View(chimerics_joel)
setdiff(unique(chimerics_new[chimerics_new$condition=="Dessication",]$gene), unique(chimerics_joel[chimerics_joel$condition=="Dessication",]$gene))
View(chimerics_new)
coverage <- readRDS("/home/mcoronado/Desktop/coverage.rds")
View(coverage)
dest_samps <- fread("https://raw.githubusercontent.com/DEST-bio/DESTv2/refs/heads/main/populationInfo/dest_v2.samps_24Aug2024.csv")
dest_samps
coverage$sampleId<-rownames(coverage)
length(intersect(coverage$sampleId,dest_samps$sampleId))
length(setdiff(coverage$sampleId,dest_samps$sampleId))
setdiff(coverage$sampleId,dest_samps$sampleId)
View(dest_samps)
View(coverage)
View(dest_samps)
setwd("/run/user/1000/gvfs/sftp:host=ft3.cesga.es,user=csgcymcz/mnt/netapp2/Home_FT2/home/csic/gcy/mcz/scratch/DEST_v2_Fst/ANALYSIS")
setwd("/run/user/1000/gvfs/sftp:host=ft3.cesga.es,user=csgcymcz/mnt/netapp2/Home_FT2/home/csic/gcy/mcz/scratch/DEST_v2_Fst/ANALYSIS_R1")
library(data.table)
library(gggenes)
library(ggthemes)
library(cowplot)
library(ggplot2)
library(dplyr)
fst <- fread("RESULTS_k4/hierFST_k4_10.csv")
fst <- fread("RESULTS_k4/hierFST_k4_10.sort.csv")
fgt_all_NA_SA<-ggplot(data = fst[fst$chrom=="2R" & fst$continents=="4-North_America:4-South_America", ], aes(x = chromStart, y = FGT)) +
geom_rect(xmin = 12162496, xmax = 12259496, ymin = -Inf, ymax = Inf,
fill = "lightblue", alpha = 0.2) +
geom_line() + scale_x_continuous(expand = expansion(mult = c(0, .01)), labels = scales::unit_format(unit = "M", scale = 1e-6)) + theme_base() + labs(x="", title="North America (4) vs. South America (4)", y = expression(F[GT])) +
theme(plot.background = element_rect(
color = "white"
))
fgt_all_NA_SA
fgt_all_SA_E<-ggplot(data = fst[fst$chrom=="2R" & fst$continents=="3-Europe:4-South_America", ], aes(x = chromStart, y = FGT)) +
geom_rect(xmin = 12162496, xmax = 12259496, ymin = -Inf, ymax = Inf,
fill = "lightblue", alpha = 0.2) +
geom_line() + scale_x_continuous(expand = expansion(mult = c(0, .01)), labels = scales::unit_format(unit = "M", scale = 1e-6)) + theme_base() + labs(x="", title="South America (4) vs. Europe W (3)", y = expression(F[GT])) +
theme(plot.background = element_rect(
color = "white"
))
fgt_all_SA_E
fgt_all_NA_EU<-ggplot(data = fst[fst$chrom=="2R" & fst$continents=="3-Europe:4-North_America", ], aes(x = chromStart, y = FGT)) +
geom_rect(xmin = 12162496, xmax = 12259496, ymin = -Inf, ymax = Inf,
fill = "lightblue", alpha = 0.2) +
geom_line() + scale_x_continuous(expand = expansion(mult = c(0, .01)), labels = scales::unit_format(unit = "M", scale = 1e-6)) + theme_base() + labs(x="", title="North America (4) vs. Europe W (3)", y = expression(F[GT])) +
theme(plot.background = element_rect(
color = "white"
))
fgt_all_NA_EU
fgt_all<-fgt_all_NA_EU
fst_plot<-ggplot(data = fst[fst$chrom=="2R" & fst$continents=="3-Europe:4-North_America" | fst$chrom=="2R" & fst$continents=="4-North_America:4-South_America" | fst$chrom=="2R" & fst$continents=="3-Europe:4-South_America", ], aes(x = chromStart, y = FGT, color=continents)) + geom_line() + scale_x_continuous(expand = expansion(mult = c(0, .01)), labels = scales::unit_format(unit = "M", scale = 1e-6)) + theme_base() + labs(x="",  y = expression(F[GT]), color="Cluster-continent\ncomparison") + xlim(c(12162496,12259496)) + theme(panel.grid.major.x = element_blank(),panel.grid.minor.x = element_blank(), axis.text.x = element_blank(), axis.ticks.x  = element_blank()) +
theme(plot.background = element_rect(
color = "white"
)) + theme(legend.position = "bottom") +
scale_color_hc() +guides(color=guide_legend(nrow=2,byrow=TRUE))
fst_plot
genes <- fread("genes.txt")
genes <- fread("genes.txt")
genes_filtered <- genes[grepl("^Cyp", genes$gene), ]
genes$kk<-genes$gene
genes$color<-"gray"
genes[!grepl("^Cyp", genes$gene), ]$kk <- ""
genes[grepl("^Cyp", genes$gene), ]$color <- "lightblue"
gene_plot<-ggplot(genes, aes(xmin = start, xmax = end, y = molecule, group = gene, fill=color, forward = orientation)) +
geom_gene_arrow(position = position_dodge(width = 2), arrow_body_height = grid::unit(5, "mm"), arrowhead_height = grid::unit(5, "mm")) +
facet_wrap(~ molecule, scales = "free", ncol = 1) +
scale_fill_identity() +
geom_text(data = genes %>% mutate(start = (start + end)/2), aes(x = start, y = molecule, label = kk), position = position_dodge(width = 2), size = 3,  fontface = "italic",vjust = -2) + theme_genes() + guides(fill = F) + labs(y="", x="Chromosome 2R")+ theme(panel.grid.major.y = element_blank(),panel.grid.minor.y = element_blank(), axis.text.y = element_blank()) + theme(axis.text.x = element_text(size = 14, color = "black")) + theme(axis.title.x = element_text(face = "bold", size = 16)) + scale_x_continuous(expand = expansion(mult = c(0, .01)), labels = scales::unit_format(unit = "M", scale = 1e-6), lim = c(12162496,12259496)) +
theme(plot.background = element_rect(
color = "white"
))
gene_plot
plot_grid(fgt_all, fst_plot,gene_plot, align = "hv", nrow = 3, rel_heights = c(0.5,1,0.3))
ggsave(filename="FGT_EU_NA_Cyp6g1_k4_R01.pdf", plot_grid(fgt_all, fst_plot,gene_plot, align = "hv", nrow = 3, rel_heights = c(0.5,1,0.2)), width = 23, height = 13)
ggsave(filename="FGT_all_k4_R01.pdf", plot_grid(fgt_all_NA_EU,fgt_all_NA_SA,fgt_all_SA_E+labs(x="Chromosome 2R"), align = "hv", nrow = 3), width = 15, height = 6)
plot_grid(fgt_all_NA_EU,fgt_all_NA_SA,fgt_all_SA_E,fst_plot,gene_plot, align = "hv", nrow = 5, rel_heights = c(1,1,1,2,1))
ggsave(filename="Fig_s12_R01.pdf", plot_grid(fgt_all_NA_EU,fgt_all_NA_SA,fgt_all_SA_E,fst_plot,gene_plot, align = "hv", nrow = 5, rel_heights = c(1,1,1,2,2.5))
, width = 10, height = 15)
setwd("/run/user/1000/gvfs/sftp:host=ft3.cesga.es,user=csgcymcz/mnt/netapp2/Home_FT2/home/csic/gcy/mcz/scratch/DEST_v2_Fst/ANALYSIS/GOWINDA_ANALYSIS_k4")
gowinda <- fread("PARSED_OUTPUT/gowinda_top5_fgt_0.2_1-Africa.txt")
colnames(gowinda) <- c("comparison", "GO", "FDR", "term")
gowinda <- gowinda %>%
group_by(term) %>%
mutate(unique_comparisons = n_distinct(comparison)) %>%
ungroup()
africa_1 <- ggplot(na.omit(gowinda), aes(x = comparison, y = reorder(term, unique_comparisons), fill = FDR)) +
geom_tile() +
theme_cowplot() + labs(x="", y= "") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +  scale_fill_viridis_c(limits = fdr_limits) + scale_y_discrete(labels = function(x) str_wrap(x, width = 50))
africa_1
fdr_limits <- c(0.00005, 0.05)
africa_1 <- ggplot(na.omit(gowinda), aes(x = comparison, y = reorder(term, unique_comparisons), fill = FDR)) +
geom_tile() +
theme_cowplot() + labs(x="", y= "") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +  scale_fill_viridis_c(limits = fdr_limits) + scale_y_discrete(labels = function(x) str_wrap(x, width = 50))
africa_1
gowinda <- fread("PARSED_OUTPUT/gowinda_top5_fgt_0.2_2-Africa.txt")
colnames(gowinda) <- c("comparison", "GO", "FDR", "term")
gowinda <- gowinda %>%
group_by(term) %>%
mutate(unique_comparisons = n_distinct(comparison)) %>%
ungroup()
gowinda <- fread("PARSED_OUTPUT/gowinda_top5_fgt_0.2_2-Africa.txt")
gowinda <- fread("PARSED_OUTPUT/gowinda_top5_fgt_0.2_2-Europe.txt")
colnames(gowinda) <- c("comparison", "GO", "FDR", "term")
gowinda <- gowinda %>%
group_by(term) %>%
mutate(unique_comparisons = n_distinct(comparison)) %>%
ungroup()
europe_2 <- ggplot(na.omit(gowinda), aes(x = comparison, y = reorder(term, unique_comparisons), fill = FDR)) +
geom_tile() +
theme_cowplot() + labs(x="", y= "") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +  scale_fill_viridis_c(limits = fdr_limits) + scale_y_discrete(labels = function(x) str_wrap(x, width = 50))
europe_2
gowinda <- fread("PARSED_OUTPUT/gowinda_top5_fgt_0.2_4-North_America.txt")
colnames(gowinda) <- c("comparison", "GO", "FDR", "term")
gowinda <- gowinda %>%
group_by(term) %>%
mutate(unique_comparisons = n_distinct(comparison)) %>%
ungroup()
northamerica_4<- ggplot(na.omit(gowinda), aes(x = comparison, y = reorder(term, unique_comparisons), fill = FDR)) +
geom_tile() +
theme_cowplot() + labs(x="", y= "") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +  scale_fill_viridis_c(limits = fdr_limits) + scale_y_discrete(labels = function(x) str_wrap(x, width = 50))
northamerica_4
gowinda <- fread("PARSED_OUTPUT/gowinda_top5_fgt_0.2_4-South_America.txt")
colnames(gowinda) <- c("comparison", "GO", "FDR", "term")
gowinda <- gowinda %>%
group_by(term) %>%
mutate(unique_comparisons = n_distinct(comparison)) %>%
ungroup()
southamerica_4<- ggplot(na.omit(gowinda), aes(x = comparison, y = reorder(term, unique_comparisons), fill = FDR)) +
geom_tile() +
theme_cowplot() + labs(x="", y= "") +
theme(axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1)) +  scale_fill_viridis_c(limits = fdr_limits) + scale_y_discrete(labels = function(x) str_wrap(x, width = 50))
southamerica_4
# Read the data (assuming tab-separated file)
data <- read.table("recombination_comeron_r6.txt", header = TRUE, sep = "\t")
setwd("/run/user/1000/gvfs/sftp:host=ft3.cesga.es,user=csgcymcz/mnt/netapp2/Home_FT2/home/csic/gcy/mcz/scratch/DEST_v2_Fst/ANALYSIS_R1")
# Read the data (assuming tab-separated file)
data <- read.table("recombination_comeron_r6.txt", header = TRUE, sep = "\t")
# Define function to split each 100 kb window into 10 subwindows of 10 kb
expand_windows <- function(df) {
new_df <- df %>%
rowwise() %>%
do({
start_seq <- seq(.$Start, .$End - 9999, by = 10000)
end_seq <- start_seq + 9999
data.frame(
Chr = rep(.$Chr, length(start_seq)),
Start = start_seq,
End = end_seq,
Value = rep(.$`Comeron.et.al..2012`, length(start_seq))
)
})
return(new_df)
}
# Apply function
expanded_data <- expand_windows(data)
# View output
head(expanded_data)
expanded_data -> recombination
recombination
gene_density <- fread("gene_density_10kb.bed")
gene_density
gene_density <- gene_density %>%
mutate(start = start + 1)
fst <- fread("RESULTS_k4/hierFST_k4_10.sort.csv")
merged_data_fst <- fst %>%
inner_join(gene_density, by = c("chrom" = "chrom", "chromStart" = "start", "chromEnd" = "end"))
merged_data_fst <- fst %>%
inner_join(recombination, by = c("chrom" = "Chr", "chromStart" = "Start", "chromEnd" = "End"))
merged_data_fst
gene_density
gene_density <- fread("gene_density_10kb.bed")
gene_density
gene_density <- fread("gene_density_10kb.bed")
colnames(gene_density) <- c("chrom", "start", "end", "gene_density")
gene_density <- gene_density %>%
mutate(start = start + 1)
fst <- fread("RESULTS_k4/hierFST_k4_10.sort.csv")
merged_data_fst <- fst %>%
inner_join(gene_density, by = c("chrom" = "chrom", "chromStart" = "start", "chromEnd" = "end"))
merged_data_fst <- fst %>%
inner_join(recombination, by = c("chrom" = "Chr", "chromStart" = "Start", "chromEnd" = "End"))
View(merged_data_fst)
merged_data_fst <- fst %>%
inner_join(gene_density, by = c("chrom" = "chrom", "chromStart" = "start", "chromEnd" = "end"))
merged_data_fst <- merged_data_fst %>%
inner_join(recombination, by = c("chrom" = "Chr", "chromStart" = "Start", "chromEnd" = "End"))
merged_data_fst
cor_results <- merged_data_fst %>%
group_by(continents) %>%
summarise(
cor_FGT_gene_density = cor(FGT, gene_density, use = "complete.obs"),
cor_FGT_recombination = cor(FGT, Value, use = "complete.obs")
)
print(cor_results)
merged_data_fst
print(cor_results)
cor_results <- merged_data_fst %>%
group_by(continents) %>%
summarise(
cor_FGT_gene_density = cor(FGT, gene_density, use = "pairwise.complete.obs"),
cor_FGT_recombination = cor(FGT, Value, use = "pairwise.complete.obs")
) %>%
ungroup()
print(cor_results)
merged_data_fst %>%
group_by(continents) %>%
summarise(n = n(), missing_FGT = sum(is.na(FGT)), missing_gene_density = sum(is.na(gene_density)), missing_Value = sum(is.na(Value)))
unique(merged_data_fst$continents)
merged_data_fst %>%
group_by(continents) %>%
summarise(count = n()) %>%
print()
merged_data_fst %>%
group_by(continents) %>%
summarise(count = dplyr::n()) %>%
print()
merged_data_fst
cor(merged_data_fst$FGT,merged_data_fst$Value)
cor(merged_data_fst[merged_data_fst$continents=="1-Africa:3-Europe",]$FGT,merged_data_fst$Value)
cor(merged_data_fst[merged_data_fst$continents=="1-Africa:3-Europe",]$FGT,merged_data_fst[merged_data_fst$continents=="1-Africa:3-Europe",]$$Value)
cor(merged_data_fst[merged_data_fst$continents=="1-Africa:3-Europe",]$FGT,merged_data_fst[merged_data_fst$continents=="1-Africa:3-Europe",]$Value)
filtered_data <- merged_data_fst[merged_data_fst$continents == "1-Africa:3-Europe",]
filtered_data <- na.omit(filtered_data[, c("FGT", "Value")])
cor(filtered_data$FGT, filtered_data$Value)
View(filtered_data)
filtered_data <- merged_data_fst[merged_data_fst$continents == "1-Africa:3-Europe",]
View(filtered_data)
filtered_data <- merged_data_fst[merged_data_fst$continents == "3-Africa:4-North_America",]
cor(filtered_data$FGT, filtered_data$Value)
View(filtered_data)
unique(merged_data_fst$continents )
# Create an empty dataframe to store results
cor_results_all <- data.frame(
continents = character(0),
cor_FGT_gene_density = numeric(0),
cor_FGT_recombination = numeric(0),
stringsAsFactors = FALSE
)
# Loop through each unique continent and calculate the correlation
for (continent in unique(merged_data_fst$continents)) {
filtered_data <- merged_data_fst[merged_data_fst$continents == continent,]
# Calculate correlation for FGT vs gene_density
cor_FGT_gene_density <- cor(filtered_data$FGT, filtered_data$gene_density, use = "pairwise.complete.obs")
# Calculate correlation for FGT vs recombination (Value)
cor_FGT_recombination <- cor(filtered_data$FGT, filtered_data$Value, use = "pairwise.complete.obs")
# Store the results
cor_results_all <- rbind(cor_results_all, data.frame(
continents = continent,
cor_FGT_gene_density = cor_FGT_gene_density,
cor_FGT_recombination = cor_FGT_recombination
))
}
# View the final results
print(cor_results_all)
View(cor_results_all)
# Create an empty dataframe to store results
cor_results_all <- data.frame(
continents = character(0),
cor_FGT_gene_density = numeric(0),
p_value_FGT_gene_density = numeric(0),
cor_FGT_recombination = numeric(0),
p_value_FGT_recombination = numeric(0),
stringsAsFactors = FALSE
)
# Loop through each unique continent and calculate the correlation
for (continent in unique(merged_data_fst$continents)) {
filtered_data <- merged_data_fst[merged_data_fst$continents == continent,]
# Correlation for FGT vs gene_density
cor_FGT_gene_density <- cor(filtered_data$FGT, filtered_data$gene_density, use = "pairwise.complete.obs")
cor_test_gene_density <- cor.test(filtered_data$FGT, filtered_data$gene_density, use = "pairwise.complete.obs")
p_value_FGT_gene_density <- cor_test_gene_density$p.value
# Correlation for FGT vs recombination (Value)
cor_FGT_recombination <- cor(filtered_data$FGT, filtered_data$Value, use = "pairwise.complete.obs")
cor_test_recombination <- cor.test(filtered_data$FGT, filtered_data$Value, use = "pairwise.complete.obs")
p_value_FGT_recombination <- cor_test_recombination$p.value
# Store the results
cor_results_all <- rbind(cor_results_all, data.frame(
continents = continent,
cor_FGT_gene_density = cor_FGT_gene_density,
p_value_FGT_gene_density = p_value_FGT_gene_density,
cor_FGT_recombination = cor_FGT_recombination,
p_value_FGT_recombination = p_value_FGT_recombination
))
}
# View the final results
print(cor_results_all)
View(cor_results_all)
28/36
# Create an empty dataframe to store results
cor_results_all <- data.frame(
continents = character(0),
cor_FGT_gene_density = numeric(0),
p_value_FGT_gene_density = numeric(0),
cor_FGT_recombination = numeric(0),
p_value_FGT_recombination = numeric(0),
stringsAsFactors = FALSE
)
# Loop through each unique continent and calculate the correlation
for (continent in unique(merged_data_fst$continents)) {
filtered_data <- merged_data_fst[merged_data_fst$continents == continent,]
# Correlation for FGT vs gene_density
cor_FGT_gene_density <- cor(filtered_data$FGT, filtered_data$gene_density)
cor_test_gene_density <- cor.test(filtered_data$FGT, filtered_data$gene_density)
p_value_FGT_gene_density <- cor_test_gene_density$p.value
# Correlation for FGT vs recombination (Value)
cor_FGT_recombination <- cor(filtered_data$FGT, filtered_data$Value)
cor_test_recombination <- cor.test(filtered_data$FGT, filtered_data$Value)
p_value_FGT_recombination <- cor_test_recombination$p.value
# Store the results
cor_results_all <- rbind(cor_results_all, data.frame(
continents = continent,
cor_FGT_gene_density = cor_FGT_gene_density,
p_value_FGT_gene_density = p_value_FGT_gene_density,
cor_FGT_recombination = cor_FGT_recombination,
p_value_FGT_recombination = p_value_FGT_recombination
))
}
# View the final results
print(cor_results_all)
View(cor_results_all)
# Loop through each unique continent and calculate the correlation
for (continent in unique(merged_data_fst$continents)) {
filtered_data <- merged_data_fst[merged_data_fst$continents == continent,]
# Correlation for FGT vs gene_density
cor_FGT_gene_density <- cor(filtered_data$FGT, filtered_data$gene_density, use = "pairwise.complete.obs")
cor_test_gene_density <- cor.test(filtered_data$FGT, filtered_data$gene_density, use = "pairwise.complete.obs")
p_value_FGT_gene_density <- cor_test_gene_density$p.value
# Correlation for FGT vs recombination (Value)
cor_FGT_recombination <- cor(filtered_data$FGT, filtered_data$Value, use = "pairwise.complete.obs")
cor_test_recombination <- cor.test(filtered_data$FGT, filtered_data$Value, use = "pairwise.complete.obs")
p_value_FGT_recombination <- cor_test_recombination$p.value
# Store the results
cor_results_all <- rbind(cor_results_all, data.frame(
continents = continent,
cor_FGT_gene_density = cor_FGT_gene_density,
p_value_FGT_gene_density = p_value_FGT_gene_density,
cor_FGT_recombination = cor_FGT_recombination,
p_value_FGT_recombination = p_value_FGT_recombination
))
}
# View the final results
print(cor_results_all)
# Create an empty dataframe to store results
cor_results_all <- data.frame(
continents = character(0),
cor_FGT_gene_density = numeric(0),
p_value_FGT_gene_density = numeric(0),
cor_FGT_recombination = numeric(0),
p_value_FGT_recombination = numeric(0),
stringsAsFactors = FALSE
)
# Loop through each unique continent and calculate the correlation
for (continent in unique(merged_data_fst$continents)) {
filtered_data <- merged_data_fst[merged_data_fst$continents == continent,]
# Correlation for FGT vs gene_density
cor_FGT_gene_density <- cor(filtered_data$FGT, filtered_data$gene_density, use = "pairwise.complete.obs")
cor_test_gene_density <- cor.test(filtered_data$FGT, filtered_data$gene_density, use = "pairwise.complete.obs")
p_value_FGT_gene_density <- cor_test_gene_density$p.value
# Correlation for FGT vs recombination (Value)
cor_FGT_recombination <- cor(filtered_data$FGT, filtered_data$Value, use = "pairwise.complete.obs")
cor_test_recombination <- cor.test(filtered_data$FGT, filtered_data$Value, use = "pairwise.complete.obs")
p_value_FGT_recombination <- cor_test_recombination$p.value
# Store the results
cor_results_all <- rbind(cor_results_all, data.frame(
continents = continent,
cor_FGT_gene_density = cor_FGT_gene_density,
p_value_FGT_gene_density = p_value_FGT_gene_density,
cor_FGT_recombination = cor_FGT_recombination,
p_value_FGT_recombination = p_value_FGT_recombination
))
}
# View the final results
print(cor_results_all)
write.table(cor_results_all, "corr_recomb_geneDensity_fgt.tsv", header = T, sep = "\t", quote = F, col.names = T, row.names = F)
write.table(cor_results_all, "corr_recomb_geneDensity_fgt.tsv", sep = "\t", quote = F, col.names = T, row.names = F)
setwd("~/Dropbox/DOCENCIA/UPC/DataVisualization/Course24-25/Theory/T2.2")
devtools::install_github("jespermaag/gganatogram")
pagedown::chrome_print("T2.2_slides.html")
unlink("T2.2_slides_cache", recursive = TRUE)
pagedown::chrome_print("T2.2_slides.html")
pagedown::chrome_print("T2.2_slides.html")
pagedown::chrome_print("T2.2_slides_solutions.html")
library(poolfstat)
??poolfstat
