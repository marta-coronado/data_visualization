---
title: "**Data visualization**"
subtitle: "Course introduction"
author: "<b>Marta Coronado Zamora; Jose F. S치nchez-Herrero; Miriam Merenciano</b>"
date: "12 February 2026"
output:
  xaringan::moon_reader:
    css: ["default", "rutgers", "metropolis-fonts", "https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css", "https://use.fontawesome.com/releases/v7.0.0/css/all.css"]
    lib_dir: libs
    self_contained: true
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: "16:9"
      
---
```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
# Animations: https://github.com/daneden/animate.css#animations
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, fig.width = 4.5, fig.height = 3.5, fig.show = 'hold', message = FALSE)

library(ggplot2)
library(lattice)

# Package for slides
# remotes::install_github('yihui/xaringan')

# viewer: xaringan::inf_mr()

# Export to pdf
# install.packages("pagedown")
# pagedown::chrome_print("CoursePresentation-18.09.24.html")
```


```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_accent(
  base_color = "#1c5253", link_color =  "#DE1144", code_inline_color = "#DE1144",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "400", "400i"),
  code_font_google   = google_font("Roboto Mono"),
    
)
```

```{r xaringanExtra-clipboard, echo=FALSE}
library(xaringanExtra)
htmltools::tagList(
  xaringanExtra::use_clipboard(
    button_text = "<i class=\"fa fa-clipboard\"></i>",
    success_text = "<i class=\"fa fa-check\" style=\"color: #90BE6D\"></i>",
  ),
  rmarkdown::html_dependency_font_awesome()
)
```



class: center, middle, animated, bounceInDown

<style>
.title-slide {
  background-image: url(img/logo.png);
  background-size: 250px;
}
</style>


## Keep in touch

#### Theory lessons <br>

| Marta Coronado Zamora | Jose F. S치nchez | 
|:-:|:-:|
| <a href="mailto:Marta.coronado@uab.cat"><i class="fa fa-paper-plane fa-fw"></i> marta.coronado@uab.cat</a> | <a href="mailto:JoseFrancisco.Sanchez@uab.cat"><i class="fa fa-paper-plane fa-fw"></i>&nbsp; josefrancisco.sanchez@uab.cat</a> | 
| <a href="https://bsky.app/profile/geneticament.bsky.social"><i class="fab fa-bluesky fa-fw"></i>&nbsp; @geneticament</a> |                 <a href="https://twitter.com/JFSanchezBioinf"><i class="fab fa-twitter fa-fw"></i>&nbsp; @JFSanchezBioinf</a> |
| <a href="https://portalrecerca.uab.cat/es/organisations/grup-de-gen%C3%B2mica-bioinform%C3%A0tica-i-biologia-evolutiva-gbbe/"><i class="fa fa-map-marker fa-fw"></i>&nbsp; Universitat Aut쑕oma de Barcelona </a> |    <a href="http://www.germanstrias.org/technology-services/genomica-bioinformatica/"> <i class="fa fa-map-marker fa-fw"></i>Germans Trias i Pujol Research Institute (IGTP)</a> |

#### Practical lessons <br>

| Miriam Merenciano |
|:-:|
| <a href="mailto:miriam.merenciano@uab.cat"><i class="fa fa-paper-plane fa-fw"></i> miriam.merenciano@uab.cat </a> | 
|  <a href="https://portalrecerca.uab.cat/es/organisations/grup-de-gen%C3%B2mica-bioinform%C3%A0tica-i-biologia-evolutiva-gbbe/"><i class="fa fa-map-marker fa-fw"></i>&nbsp; Universitat Aut쑕oma de Barcelona </a> | 

---
layout: true
class: animated, fadeIn

---
class: animated, fadeIn

# Course overview

**P0** | Course Introduction. (<font color=" #A8A8A8">Marta Coronado Zamora & Miriam Merenciano</font>)<br><br>

--
**T1** | Introduction. Perception, illusions, inter-individual variability, ranking of visual features and common pitfalls (<font color=" #A8A8A8">Marta Coronado</font>)<br><br>

--
**Part 1: Tools for data visualization** (<font color=" #A8A8A8">Marta Coronado Zamora and Miriam Merenciano</font>)<br>
**T2** | Basic tools for data visualization (`ggplot2`) - P1, P2, P3 (first assignment)<br>
**T3** | Dynamic and interactive (`plotly`, `shiny`) - P4, P5 (second assignment)<br><br>

--
**Part 2:  Complex data and dimensionality reduction** (<font color=" #A8A8A8">Jose F. S치nchez-Herrero</font>)<br>
**T4** | Introduction: Visualization for exploring complex data & Dimensionality reduction - P6<br>
**T5** | Principal component analysis - P7<br>
**T6** | Non-linear projections: t-SNE  - P8 (third assignment)<br>
**T7** | Non-linear projections: UMAP  P9 (fourth assignment)

---
class: animated, fadeIn

# Evaluation

- **10% participation**

    Individual submission at the end of each theory/practical session

--
- **40% group assignments** (minimum grade 4/10)

    4 assignments, each 10%<br><br>

--

- **20% mid-term exam** 

- **30% final exam** 

    The weighted grade of the midterm exam and the final exam requires a minimum score of 3.5 out of 10 to consider the other parts of the evaluation. 
    
    <br>
    
    [Information in the Syllabus](https://www.fib.upc.edu/en/studies/bachelors-degrees/bachelor-degree-bioinformatics/curriculum/syllabus/DV-BBI)
    
---
class: animated, fadeIn

# Course configuration

--
- **Theoretical sessions**: 12 sessions, Friday: 14 - 16h (A5202)

--

<br>

- **Practical exercises**: 13 sessions, 2 groups. Thursday: 14 - 18h (A5201)
  
  Complete and submit to [ATENeA](https://atenea.upc.edu/course/view.php?id=105474) - individual submission

--

<br>

- **Home assignments:**
  
  Work in groups to create analyze data, create visualization, interactive reports and apps... 
  
  Complete and submit to [ATENeA](https://atenea.upc.edu/course/view.php?id=95546) - submission by group 

--

<br>


- **Seminars**:
  Invited seminars either in person or online, live or broadcast.

  - 27th March | **Clara Inserte**: `clevRvis`: visualization techniques for clonal evolution
  
---
class: animated, fadeIn

# Group assignments

- __1\.__ Create groups of 3-4 people

Make groups of 3-4students to work on the home assignments projects.

- __2\.__ Enroll in ATENeA

https://atenea.upc.edu/mod/choicegroup/view.php?id=5311480

---
class: animated, fadeIn

# Previous capacities

Basic knowledge in R and familiarity with RStudio are prerequisites.

--
<center>
<img src="img/kahoot.jpg" width=500/>
</center>

---
layout: false
class: left, bottom, inverse, animated, bounceInDown

# Let's get started!
## **Tools for data visualization**


---
layout: true
class: animated, fadeIn

---
class: animated, fadeIn

## Type of tools

### Two main types:

--

- Graphical user interface (GUI)

  <font color="#A8A8A8">Many examples: Perseus computational platform, Cytoscape, Blast2GO, Gephi, ... </font>
  
--

- Code-based

  <font color="#A8A8A8">R (and other computer languages [Python])</font>

- Interactive code-based `R`

<font color="#A8A8A8">Rstudio (Jupyter Notebook, and other computer languages)</font>

--


[Wide range...](https://en.wikipedia.org/wiki/List_of_information_graphics_software)

<br>
--

<div style="background-color:#FFDA9E">
<b><i class="fas fa-question-circle"></i>&nbsp;Question</b>
<br>
What prons and cons do you think GUI tools have in comparison to code-based? 
</div>

---

layout: true
class: animated, fadeIn

---
class: animated, fadeIn

## Slides with Rmarkdown

### **Interactive <i class="fab fa-r-project fa-fw"></i></i> documents**  
`R code` can be executed within RStudio!



--
```{r, echo=TRUE}
value <- 2
value + 3
```

--
.pull-left[
```{r, echo=TRUE, eval=F, fig.align='center', fig.height=4}
# ggplot2 boxplot
ggplot(data = iris, 
       mapping = aes(x = Species,
                     y = Petal.Length,
                     fill = Species)) +
  geom_boxplot()
```
]
.pull-right[
```{r, echo=F, fig.align='center'}
# ggplot2 boxplot
ggplot(data = iris, mapping = aes(x = Species, y = Petal.Length, fill = Species)) +
  geom_boxplot()
```
]
---
class: animated, fadeIn

## Visualization libraries in `R`

- `base`
- `grid`: `lattice` and `ggplot2`

<center>
```{r, warning = FALSE, echo = FALSE}

# Basic R boxplot
boxplot(Petal.Length ~ Species,
        data = iris,
        ylab = "Petal length",
        col = c("red", "blue", "green"),
        main = "Basic")

# Lattice boxplot
bwplot(
  Petal.Length ~ Species,
  group = Species,
  data = iris,
  main = "Lattice",
  ylab = "Petal length",
  par.settings = list(box.umbrella=list(col = c("red", "green", "blue")),
                      box.dot = list(col = c("red", "green", "blue")),
                      box.rectangle = list(col = c("red", "green", "blue"))))

# ggplot2 boxplot
ggplot(data = iris, mapping = aes(x = Species, y = Petal.Length, fill = Species)) +
  geom_boxplot() +
  ylab("Petal length") +
  ggtitle("ggplot2")
```

<br>
--

<div align="left" style="background-color:#FFDA9E">
<b><i class="fas fa-question-circle"></i>&nbsp;Question</b>
<br>
Describe the graphics. In your opinion, which do you think is the simplest? and the most complex? do you think the code to generate the figures reflect the complexity?
</div>

---
class: animated, fadeIn

## Visualization libraries in `R`

```{r, echo=TRUE, message=FALSE, eval = FALSE}
# base
hist(iris$Sepal.Width)

# ggplot2
ggplot(iris, aes(Sepal.Width)) +
  geom_histogram()
```

<center>
```{r, echo=FALSE, message=FALSE}
# base
hist(iris$Sepal.Width)

# ggplot2
ggplot(iris, aes(Sepal.Width)) +
  geom_histogram()
```

---
class: animated, fadeIn

## Visualization libraries in `R`

.pull-left[
```{r, echo = TRUE, eval = FALSE}
# base
plot(circumference ~ age,
     data=Orange[Orange$Tree %in% "4", ], type = "l",
     main = "Base - complex")
points(circumference ~ age, col="darkred",
       data=Orange[Orange$Tree %in% "2", ], type = "l")
points(circumference ~ age, col="orange",
       data=Orange[Orange$Tree %in% "5", ], type = "l")
points(circumference ~ age, col="yellow",
       data=Orange[Orange$Tree %in% "1", ], type = "l")
points(circumference ~ age, col="darkgreen",
       data=Orange[Orange$Tree %in% "3", ], type = "l")
legend("topleft",
       c("4", "2", "5", "1", "3"), title="Tree",
       col=c("black", "darkred", "darkorange", "yellow", "darkgreen"),
       lty=c(1, 1, 1, 1, 1))
```

```{r, echo = TRUE, eval = FALSE}
# ggplot2
ggplot(Orange, aes(age, circumference,
      colour = Tree)) + geom_line() +
      labs(title = "ggplot2 - complex")
```
]

--
.pull-right[
```{r, echo=FALSE, fig.keep='last', fig.width=5, fig.height=3.5, fig.align="center"}
# base
plot(circumference ~ age,
     data=Orange[Orange$Tree %in% "4", ], type = "l",
     main = "Base - complex")
points(circumference ~ age, col="darkred",
       data=Orange[Orange$Tree %in% "2", ], type = "l")
points(circumference ~ age, col="orange",
       data=Orange[Orange$Tree %in% "5", ], type = "l")
points(circumference ~ age, col="yellow",
       data=Orange[Orange$Tree %in% "1", ], type = "l")
points(circumference ~ age, col="darkgreen",
       data=Orange[Orange$Tree %in% "3", ], type = "l")
legend("topleft",
       c("4", "2", "5", "1", "3"), title="Tree",
       col=c("black", "darkred", "darkorange", "yellow", "darkgreen"),
       lty=c(1, 1, 1, 1, 1))
```

```{r, echo=FALSE, fig.width=5, fig.height=2.5, fig.align="center"}
# ggplot2
ggplot(Orange, aes(age, circumference, colour = Tree)) +
  geom_line()+
  labs(title = "ggplot2 - complex")
```
]


---
class: animated, fadeIn

### Other visualization libraries

(Outside our scope)

- Python
    + `matplotlib`, `seaborn`
    + `Bokeh`, `pygal`
- Java: `Processing`
- Javascript: `D3.js`

<center>
<img src="img/190840954-dc243c99-9295-44de-88e9-fafd0f4f7f8a.jpg" alt="Bokeh plots" width=80%/>
</center>

---
layout: false
class: left, bottom, inverse, animated, bounceInDown

# Basic `R` knowledge

---
layout: true
class: animated, fadeIn

---
class: animated, fadeIn

### Installing a package

```{r, eval = FALSE, echo = TRUE}
# Download and install a package from CRAN
install.packages("ggplot2")

# Download and install a package from GitHub(you need the devtools library installed)
devtools::install_github("yihui/xaringan")
```

### Loading a package

```{r, eval = FALSE, echo = TRUE}
# Load the library to the current session
library("ggplot2")
library("xaringan")
```

### Loading data

```{r, eval = FALSE, echo = TRUE}
# Loading a tab-separated file with a header
data <- read.table("data.txt", header = TRUE, sep = "\t")
```

---
class: animated, fadeIn

## Data types and structures

Main data types <font color=" #A8A8A8">(other will not be discussed: _complex_ and _raw_)</font>:

- __Logical__: can only take on two values: true (`TRUE`, `T`) or false (`FALSE`, `F`)
- __Numeric__: real or decimal (`2`, `15.5`)
- __Integer__: `2L` (the `L` tells R to store this as an integer)
- __Character__: any type of character or number (`"a"`, `"swc"`, `"2"`)

--

<i class="fas fa-info-circle"></i> To know the data type, you can use the `class()` function.


```{r, echo = TRUE}
type_list <- list(TRUE, 1.2, 10L, "a")
sapply(type_list, class)
```

---
class: animated, fadeIn

## Data types and structures

Elements of the previous data types may be combined to form data structures. Main structures:

- __Vector__: collection of elements that holds data of a single data type
- __Matrix__: vector with dimensions (the number of rows and columns)
- __Factor__: to deal with categorical variables
- __List__: a special type of vector where each element can be a different type
- __Data Frame__ <i class="fas fa-star"></i>: a special type of list where every element of the list has same length 

--
```{r, echo = TRUE}
# A vector x of mode numeric
x <- c(1, 2, 3)

# A vector y of mode logical
y <- c(TRUE, TRUE, FALSE, FALSE)

# A vector z of mode character
z <- c("ATG", "GGC", "TGA")
```

---
class: animated, fadeIn

## Data types and structures

Elements of the previous data types may be combined to form data structures. Main structures:

- __Vector__: collection of elements that holds data of a single data type
- __Matrix__: vector with dimensions (the number of rows and columns)
- __Factor__: to deal with categorical variables
- __List__: a special type of vector where each element can be a different type
- __Data Frame__ <i class="fas fa-star"></i>: a special type of list where every element of the list has same length 

```{r, echo = TRUE}
matrix22 <- matrix(
  c(1, 2, 3, 4),
  nrow = 2,
  ncol = 2)
matrix22
```

---
class: animated, fadeIn

## Data types and structures

Elements of the previous data types may be combined to form data structures. Main structures:

- __Vector__: collection of elements that holds data of a single data type
- __Matrix__: vector with dimensions (the number of rows and columns)
- __Factor__: to deal with categorical variables
- __List__: a special type of vector where each element can be a different type
- __Data Frame__ <i class="fas fa-star"></i>: a special type of list where every element of the list has same length 

```{r, echo = TRUE}
factor_vector <- as.factor(c("rna", "dna", "dna", "rna"))
factor_vector
str(factor_vector)
```

---
class: animated, fadeIn

## Data types and structures

Elements of the previous data types may be combined to form data structures. Main structures:

- __Vector__: collection of elements that holds data of a single data type
- __Matrix__: vector with dimensions (the number of rows and columns)
- __Factor__: to deal with categorical variables
- __List__: a special type of vector where each element can be a different type
- __Data Frame__ <i class="fas fa-star"></i>: a special type of list where every element of the list has same length 

```{r, echo = TRUE}
x <- list(1, "a", TRUE, 1+4i)
x
```

---
class: animated, fadeIn

## Data types and structures

Elements of the previous data types may be combined to form data structures. Main structures:

- __Vector__: collection of elements that holds data of a single data type
- __Matrix__: vector with dimensions (the number of rows and columns)
- __Factor__: to deal with categorical variables
- __List__: a special type of vector where each element can be a different type
- __Data Frame__ <i class="fas fa-star"></i>: a special type of list where every element of the list has same length 

```{r, echo = TRUE}
dat <- data.frame(id = letters[1:10], x = 1:10, y = 11:20)
dat
```
---
class: animated, fadeIn

# Additional resources

- Other subjects within this degree

- DataCamp courses: https://www.datacamp.com/

- Coursera: https://www.coursera.org/

- W3Schools: https://www.w3schools.com/r/

<center>
<img src="img/W3Schools_logo.svg.png" />
</center>



---
class: animated, fadeIn

### Tidy data

Data frames with one observation per row and one variable per column.

<center>
<img src="img/tidy-1.png" alt="Bokeh plots" width="900"/>
</center>

---
class: animated, fadeIn

### Tidy data

Two types of ordered data structures:

- **Wide format** (the most common): in a wide format, multiple measurements of a single observation are stored in a single row.

```{r, eval = TRUE, echo = F}
options(width = 300)

wide_df <- data.frame(
  Student = c("A", "B", "C"),
  Math = c(99, 73, 12),
  Literature = c(45, 78, 96),
  PE = c(56, 55, 57)
)
wide_df
```

--
class: animated, fadeIn

- **Long format**: each row corresponds to one measurement of an observation.

```{r, eval = TRUE, echo = F}
library(tidyverse)
long_df <- pivot_longer(
  wide_df,
  cols = c(Math, Literature, PE),
  names_to = "Subject",
  values_to = "Score"
)
long_df
```


---
class: animated, fadeIn

### Tidy data

There are functions to convert from wide format to long format:

```{r eval = TRUE, echo = TRUE}
library(tidyr)

long_df <- pivot_longer(
  wide_df,
  cols = c(Math, Literature, PE), # o  cols = -c(Student),
  names_to = "Subject",
  values_to = "Score"
  )
long_df
``` 
  

---
class: animated, fadeIn

# Getting help <i class="fas fa-question-circle"></i>

- `?read.table`, `?str`, `?as.factor`
- Press F1 (in RStudio)
- [Stack Overflow](https://stackoverflow.com) ([`R`](https://stackoverflow.com/questions/tagged/r), [`ggplot2`](https://stackoverflow.com/questions/tagged/ggplot2))
- Ask your classmates or your teacher

---
layout: false
class: left, bottom, inverse, animated, bounceInDown

# Today's task

---
class: animated, fadeIn

# Today's task

1. Make sure **RStudio** is working
2. Make groups of 3-4 people and fill the form at ATENeA
3. Install some packages you will need for this practical sessions:

  + `ggplot2`

  + `tidyr`
  
  + `shiny`
  
  + `plotly`

4. Work in the following exercises



---
class: animated, fadeIn

## Exercise: create some testing plots

Execute the following chunks using the [`iris`](https://en.wikipedia.org/wiki/Iris_flower_data_set) dataset and think what is going on:

```{r eval = F, echo = TRUE}
library(ggplot2)
head(iris)
str(iris)
```

---
class: animated, fadeIn

## Exercise: create some testing plots

<i class="fa fa-question-circle fa-fw"></i> What figure does the following command generate?

```{r eval = F, echo = TRUE, fig.align='center'}
ggplot(data = iris, mapping = aes(x = Species, y = Petal.Length, fill = Species)) +
  geom_boxplot()
```

<br>

--

Here we can see the distribution of the variable petal length regarding the species it belongs


---
class: animated, fadeIn

## Exercise: create some testing plots

<i class="fa fa-question-circle fa-fw"></i> What figure does the following command generate?

```{r eval = F, echo = TRUE, fig.align='center'}
ggplot(data=iris,aes(x=Sepal.Width, y=Sepal.Length, color=Species)) + geom_point() + theme_minimal()
```

<br>
--

Here we can see using a **scatter plot**, the variable sepal width and sepal length and coloured regarding the species it belongs


---
class: animated, fadeIn

## Exercise: describe a data set

Read the file in this [link](https://raw.githubusercontent.com/marta-coronado/data_visualization/refs/heads/main/P/0/data/sample.txt), ensure it has a tidy format; indicate the data type of each variable; convert to long format.

<i class="fa fa-key fa-fw"></i> Which column(s) will you use in the `cols` argument of the `pivot_longer` function?

<i class="fa fa-key fa-fw"></i> You can read directly a file from a link `read.table("https://...txt")`

Solutions in the next slides 游땒

---
class: animated, fadeIn

## Exercise: describe a data set

Read the file in this [link](https://raw.githubusercontent.com/marta-coronado/data_visualization/refs/heads/main/P/0/data/sample.txt), ensure it has a tidy format; indicate the data type of each variable; convert to long format.

```{r eval = TRUE, echo = TRUE}
data <- read.table(file="https://raw.githubusercontent.com/marta-coronado/data_visualization/refs/heads/main/P/0/data/sample.txt", header=T)
head(data)
dim(data)
```

---
class: animated, fadeIn

# Today's task

## Exercise: describe a data set

Indicate the data type of each variable.

```{r eval = TRUE, echo = TRUE}
sapply(data, class)
str(data)
```

---
class: animated, fadeIn

# Today's task

## Exercise: describe a data set

Convert from wide to long format using `tidyr::pivot_longer()`

```{r eval = TRUE, echo = TRUE}
library(tidyr)
long_df <- pivot_longer(
  data,
  cols = -c("ID", "Group"),
  names_to = "metric",
  values_to = "value"
  )
## check dimensions
dim(data_tidy)
dim(data)


```

---

class: animated, fadeIn

# Today's task

## Exercise: describe a data set

Convert from wide to long format using `tidyr::pivot_longer()`

```{r eval = TRUE, echo = TRUE}
library(tidyr)
long_df <- pivot_longer(
  data,
  cols = -c("ID", "Group"),
  names_to = "metric",
  values_to = "value"
  )

head(long_df)
```

---
class: animated, fadeIn

## See you next day

### Keep in touch

#### Theory lessons <br>

| Marta Coronado Zamora | Jose F. S치nchez | 
|:-:|:-:|
| <a href="mailto:Marta.coronado@uab.cat"><i class="fa fa-paper-plane fa-fw"></i> marta.coronado@uab.cat</a> | <a href="mailto:JoseFrancisco.Sanchez@uab.cat"><i class="fa fa-paper-plane fa-fw"></i>&nbsp; josefrancisco.sanchez@uab.cat</a> | 
| <a href="https://bsky.app/profile/geneticament.bsky.social"><i class="fab fa-bluesky fa-fw"></i>&nbsp; @geneticament</a> |                 <a href="https://twitter.com/JFSanchezBioinf"><i class="fab fa-twitter fa-fw"></i>&nbsp; @JFSanchezBioinf</a> |
| <a href="https://portalrecerca.uab.cat/es/organisations/grup-de-gen%C3%B2mica-bioinform%C3%A0tica-i-biologia-evolutiva-gbbe/"><i class="fa fa-map-marker fa-fw"></i>&nbsp; Universitat Aut쑕oma de Barcelona </a> |    <a href="http://www.germanstrias.org/technology-services/genomica-bioinformatica/"> <i class="fa fa-map-marker fa-fw"></i>Germans Trias i Pujol Research Institute (IGTP)</a> |

#### Practical lessons <br>

| Miriam Merenciano |
|:-:|
| <a href="mailto:miriam.merenciano@uab.cat"><i class="fa fa-paper-plane fa-fw"></i> miriam.merenciano@uab.cat </a> | 
|  <a href="https://portalrecerca.uab.cat/es/organisations/grup-de-gen%C3%B2mica-bioinform%C3%A0tica-i-biologia-evolutiva-gbbe/"><i class="fa fa-map-marker fa-fw"></i>&nbsp; Universitat Aut쑕oma de Barcelona </a> | 



